\input{preamble}

\begin{document}
\begin{theorem}
$G$ is the connected matching graph of some graph $H$ if and only if $G$ has a edge cover $\mathcal{Q} = \{Q_1, Q_2, \ldots, Q_3\}$ by augmented bicliques so that the following hold:
\begin{description}
{\setlength\itemindent{0.5cm}
	\item[1.] If a vertex $v$ is in three blocks, then two of them cross in the parts containing $v$.
	\item[2.] If two parts intersect in more than one vertex, then the containing blocks cross in these parts.
	\item[3.] If $q_i$ is in $[Q_j^b]$, then $Q_i$ and $Q_j$ cross in part $b$ of $Q_j$.
	\item[4.] Take parts $a$, $b$, and $c$.  If $a$ and $b$ cross. and $b$ and $c$ cross, then $a$ and $c$ cross.
	\item[5.] }
\end{description}
\end{theorem}
\begin{proof}
First we show that for any simple graph $H$ with $G = CM(H)$ we can construct a suitable decomposition $\mathcal{Q}$.
%
Consider a Krausz partition $\mathcal{P} = \{P_1, P_2, \ldots, P_l\}$ of the edges of $L(H)$.
%
Define an index set $\mathcal{I} \subset [l]\times[l]$ where $(x,y) \in \mathcal{I}$ if and only if $x < y$ and $[P_x] \cap [P_y] \neq \emptyset$.
%
For each $a = (a_1, a_2) \in \mathcal{I}$, define $S_a = [P_{a_1}] \cup [P_{a_2}]$, and let $\mathcal{S} = \{S_a: a \in \mathcal{I}\}$.
%
Now every edge of $L(H)$ is induced by some element of $\mathcal{S}$.
%
For each $S_a \in \mathcal{S}$, if there are $u \in [P_{a_1}]$ and $v \in [P_{a_2}]$ so that $u,v \neq p_{a_1a_2}$ and $u,v \in [P_k]$ for $a_1,a_2\neq k$, then remove $u$ and $v$ from $S_a$.  
%
(Note that the edges of $L(H)$ are still induced. Edges incident to $u$ previously indcued by $S_{a}$, for example, are still induced some $S_{b}$, with $b = (a_1, k)$ or $(k, a_1)$.)
%
For each $a \in \mathcal{I}$, let $Q_a$ be the complement of the graph induced by  $S_{a}$, and let $\mathcal{Q} = \{Q_a: a \in \mathcal{I}\}$.
%
Each $Q_{a}$ is an augmented biclique with the folowing properties: 
\begin{description}
	{\setlength\itemindent{25pt}
	\item[a.] $Q_{a}^1 \subseteq [P_{a_1}]$
	\item[b.] $Q_{a}^2 \subseteq [P_{a_2}]$
	\item[c.] the isolated vertex $q_{ij} = p_{a_1a_2}$.}
\end{description}
%
If at the end of this construction $Q_{a}$ induces no edges,  discard $Q_{a}$ from $\mathcal{Q}$.   

We claim that $\mathcal{Q}$ is an edge cover of $G$.
%
We will show that an edge $uv$ is in some $Q_a$ if and only if $d_{L(H)}(u,v) = 2$.
%
Suppose $uv \in E(Q_a)$.
%
This means that $u \in [P_{a_1}]$, $v \in [P_{a_2}]$, and these cliques intersect.
%
Hence, $d_{L(H)}(u,v) \leq 2$.
%
We also know that neither $u$ nor $v$ is $p_{a_1a_2}$, and there is no element of $[\mathcal{P}]$ containing both $u$ and $v$ (as otherwise they would have been removed from $Q_{a}$).
%
Thus $d_{L(H)}(u,v) \geq 2$.
%
Now suppose we have $d_{L(H)}(u',v') = 2$.  The edge $u'v' \notin E(L(H))$, so there is no element of $[\mathcal{P}]$ containing both.
%
There exists some vertex $w$ so that $u'w, v'w \in E(L(H))$, and these edges are covered by distinct, intersecting elements $[P_i]$ and $[P_j]$ of $[\mathcal{P}]$.  
%
Hence, $u'v' \in E(Q_{(i,j)})$, with $(i,j) \in \mathcal{I}$.

Next we will show that $\mathcal{Q}$ satisfies \textbf{i}, \textbf{ii} and \textbf{ii} above. 
%
Suppose $q_a$ is the isolated vertex of $Q_a$, and $q_a \in [Q_a] \cap [Q_b] = I$ for some $a \neq b \in \mathcal{I}$.
%
$q_a$ is in $[P_{a_1}]$ and $[P_{a_2}]$, as well as one of $[P_{b_1}]$ and $[P_{b_2}]$.  
%
Any vertex is used by at most two cliques of the Krausz partition, so it must be the case that $\{a_1, a_2\} \cap \{b_1, b_2\} \neq \emptyset$.  
%
WLOG, say $a_1 = b_1$ and $a_2 \neq b_2$.  
%
If $q_b \notin I$, then $q_b$ must have been removed from $Q_a$ in the maximalization step.
%
This means there must be $c \neq a_1, a_2, b_2$ so that $q_b \in [P_c]$.
%
This is impossible, as $q_b$ would then appear in three cliques of $\mathcal{P}$. 
%
So $\{q_a, q_b\} \subseteq I$.
%
So far we have that $[Q_a^1], [Q_b^1] \subseteq [P_{a_1}]$.
%
Suppose then, that there is $v \in Q_a^2 \cap Q_b^2$.
%
If this were true, $q_a$ and $q_b$ would have been removed from $Q_a^2$ and $Q_b^2$ repectively.
%

For the converse, suppose we have a graph $F$ that satisfies the above hypotheses.  
%
We will show that there exists $F'$ so that $F$ is the distance-2 graph of $F'$, and $F'$ is a line graph.
%
Take the vertex set of $F$, and for all $Q_i \in \mathcal{Q}$ add an edge $uv$ whenever $u,v \in [Q_i]$ are non-adjacent in $Q_i$.  
%
Furthermore, add all edges between $Q_i^a$ and $Q_j^b$ whenever $Q_i$ and $Q_j$ cross in $(a,b)$.
%
Call the resulting graph $F'$.
%

First we show that $F'$ is a line graph.
%
Each element of $[\mathcal{Q}]$ induces a pair of cliques intersecting in a single vertex.
%
Each of these cliques $Q_i^a$ is contained in a larger clique with vertices from partite sets crossing $Q_i^a$.  
%
This set $\mathcal{P}$ of maximal cliques form a Krausz partition of the edges of $F'$.
%
That they cover the edges of $F'$ is clear.
%
An edge added by the first step can only be covered once by hypothesis \textbf{i}.
%
An edge added by the second step is covered only once by maximality.
%
A vertex in three cliques means that some two of them cross (BY ZERO).
%
Hence the edges are properly partitioned.

Now we show that $F$ is the distance-2 graph of $F'$.  
%
If $uv \in E(F)$, then $u$ and $v$ are in intersecting cliques of $F'$, implying that $d_{F'}(u,v)\leq 2$.
%
Also, edges in $F'$ are not present in $F$,(?????) so $uv \in E(F) \implies d_{F'}(u,v) \geq 2$. 
%
Now let $d_{F'}(u',v') = 2$.  There is a vertex $w$ so that $u'w, v;w \in E(F')$.  

\end{proof}

\end{document}
